<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Lebenslife</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin-top: 40px;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }
    input, select, button {
      padding: 10px;
      margin: 5px 0;
      font-size: 16px;
      width: 100%;
      max-width: 300px;
    }
    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
      text-align: left;
      max-width: 300px;
      margin-left: auto;
      margin-right: auto;
    }
    .slider-container {
      margin-bottom: 15px;
      text-align: left;
      max-width: 300px;
      margin-left: auto;
      margin-right: auto;
    }
    .slider-container span {
      display: inline-block;
      width: 80px;
    }
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    #statsDisplay {
      margin-top: 20px;
      text-align: left;
      max-width: 300px;
      margin-left: auto;
      margin-right: auto;
      background: #f0f0f0;
      padding: 10px;
      border-radius: 6px;
    }
    #questContainer button {
      width: 100%;
      margin: 5px 0;
      text-align: left;
    }
    #timeline {
      text-align: left;
      max-width: 400px;
      margin: 20px auto;
      background: #e8f4fa;
      padding: 10px;
      border-radius: 6px;
      height: 150px;
      overflow-y: auto;
      font-size: 14px;
      border: 1px solid #ccc;
    }
    #lifeButtons button {
      width: 100px;
      margin: 5px;
    }
    #relationshipsList {
      max-width: 400px;
      margin: 20px auto;
      text-align: left;
      background: #f9f9f9;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <h1>üß¨ Lebenslife</h1>

  <div id="characterCreation">
    <p>Verteile deine 200% auf die 4 Stats (max. 100% pro Stat):</p>
    <div class="slider-container">
      <label for="glueckSlider">Gl√ºcklichkeit: <span id="glueckValue">50%</span></label>
      <input type="range" min="0" max="100" value="50" id="glueckSlider" />
    </div>
    <div class="slider-container">
      <label for="gesundheitSlider">Gesundheit: <span id="gesundheitValue">50%</span></label>
      <input type="range" min="0" max="100" value="50" id="gesundheitSlider" />
    </div>
    <div class="slider-container">
      <label for="intelligenzSlider">Intelligenz: <span id="intelligenzValue">50%</span></label>
      <input type="range" min="0" max="100" value="50" id="intelligenzSlider" />
    </div>
    <div class="slider-container">
      <label for="aussehenSlider">Aussehen: <span id="aussehenValue">50%</span></label>
      <input type="range" min="0" max="100" value="50" id="aussehenSlider" />
    </div>
    <p id="pointsLeft" style="font-weight:bold;"></p>

    <label for="nameInput">Vorname:</label>
    <input type="text" id="nameInput" placeholder="Dein Vorname" />

    <label for="nachnameInput">Nachname:</label>
    <input type="text" id="nachnameInput" placeholder="Dein Nachname" />

    <label for="herkunftLand">Herkunftsland:</label>
    <select id="herkunftLand">
      <option value="" disabled selected>Bitte w√§hlen</option>
      <option>Deutschland</option>
      <option>√ñsterreich</option>
      <option>Schweiz</option>
      <option>Andere</option>
    </select>

    <label for="ort">Ort:</label>
    <select id="ort">
      <option value="" disabled selected>Bitte w√§hlen</option>
      <option>Berlin</option>
      <option>Hamburg</option>
      <option>M√ºnchen</option>
      <option>K√∂ln</option>
      <option>Andere</option>
    </select>

    <label for="geschlecht">Geschlecht:</label>
    <select id="geschlecht">
      <option value="" disabled selected>Bitte w√§hlen</option>
      <option>M√§nnlich</option>
      <option>Weiblich</option>
    </select>

    <button id="startLifeBtn" onclick="startLife()">Leben starten</button>
  </div>

  <div id="lifeCenter" style="display:none;">
    <h2 id="welcome"></h2>
    <div id="statsDisplay"></div>

    <div id="lifeButtons" style="margin-top:20px;">
      <button id="arbeitBtn">Arbeit</button>
      <button id="ausbildungBtn">Ausbildung</button>
      <button id="freizeitBtn">Freizeit</button>
      <button id="beziehungenBtn">Beziehungen</button>
      <button id="ageUpBtn" style="background-color:#4CAF50; color:white;">+ Alter</button>
    </div>

    <div id="questContainer" style="margin-top:20px;"></div>
    <h3>Lebensverlauf:</h3>
    <div id="timeline"></div>

    <div id="relationshipsList" style="display:none;">
      <h3>Beziehungen</h3>
      <ul id="relationshipsUl"></ul>
      <button onclick="hideRelationships()">Schlie√üen</button>
    </div>
  </div>

  <script>
    let playerData = null;
    const totalPoints = 200;

    // Slider Elemente
    const glueckSlider = document.getElementById('glueckSlider');
    const gesundheitSlider = document.getElementById('gesundheitSlider');
    const intelligenzSlider = document.getElementById('intelligenzSlider');
    const aussehenSlider = document.getElementById('aussehenSlider');

    // Anzeige der Werte
    const glueckValue = document.getElementById('glueckValue');
    const gesundheitValue = document.getElementById('gesundheitValue');
    const intelligenzValue = document.getElementById('intelligenzValue');
    const aussehenValue = document.getElementById('aussehenValue');
    const pointsLeft = document.getElementById('pointsLeft');

    // Aktualisiert die Anzeige und verhindert √úberschreitung von 200%
    function updateSliders() {
      let sum = parseInt(glueckSlider.value) + parseInt(gesundheitSlider.value) + parseInt(intelligenzSlider.value) + parseInt(aussehenSlider.value);
      let left = totalPoints - sum;
      pointsLeft.textContent = `Verbleibende Punkte: ${left}`;
      glueckValue.textContent = glueckSlider.value + '%';
      gesundheitValue.textContent = gesundheitSlider.value + '%';
      intelligenzValue.textContent = intelligenzSlider.value + '%';
      aussehenValue.textContent = aussehenSlider.value + '%';

      // Falls zu viel vergeben, klemme den zuletzt ge√§nderten Slider auf max
      if(left < 0) {
        // korrigieren
        // wir wissen nicht direkt welcher Slider ge√§ndert, also einfach alle zur√ºck auf max 100 setzen
        // oder wir erlauben nicht mehr als 200, hier nur Warnung anzeigen
        pointsLeft.style.color = 'red';
      } else {
        pointsLeft.style.color = 'black';
      }
    }

    glueckSlider.addEventListener('input', () => {
      updateSliders();
    });
    gesundheitSlider.addEventListener('input', () => {
      updateSliders();
    });
    intelligenzSlider.addEventListener('input', () => {
      updateSliders();
    });
    aussehenSlider.addEventListener('input', () => {
      updateSliders();
    });

    updateSliders();

    // Clamp Funktion f√ºr Stats auf 0-100%
    function clampStat(value) {
      if(value < 0) return 0;
      if(value > 100) return 100;
      return value;
    }

    // Funktion um Beziehungen zu generieren
    function generateRelationships(name, nachname) {
      const relationships = [];

      // Elterliche Beziehungsform Wahrscheinlichkeiten:
      // 70% verheiratet (beide Eltern gleicher Nachname)
      // 10% zusammen unverheiratet (nur Vater Nachname)
      // 15% getrennt (nur Vater Nachname)
      // 5% geschieden (nur Vater Nachname)
      // 10% schwule Eltern, 10% lesbische Eltern (sind alternative Formen der Eheform, hier aufgeteilt)

      // Wir w√§hlen zuf√§llig die Elternbeziehung
      let rand = Math.random()*100;
      let status = '';
      if(rand <= 70) status = 'verheiratet';
      else if(rand <= 80) status = 'zusammen';
      else if(rand <= 95) status = 'getrennt';
      else status = 'geschieden';

      // Sexualit√§t der Eltern (10% schwul, 10% lesbisch, sonst hetero)
      let sexualParentsRand = Math.random()*100;
      let parentsSexuality = 'hetero';
      if(sexualParentsRand < 10) parentsSexuality = 'schwul';
      else if(sexualParentsRand < 20) parentsSexuality = 'lesbisch';

      // Eltern Geschlechter
      let motherGender = 'weiblich';
      let fatherGender = 'm√§nnlich';

      // Wenn schwule Eltern: beide m√§nnlich, wenn lesbisch beide weiblich
      if(parentsSexuality === 'schwul') {
        motherGender = 'm√§nnlich';
        fatherGender = 'm√§nnlich';
      } else if(parentsSexuality === 'lesbisch') {
        motherGender = 'weiblich';
        fatherGender = 'weiblich';
      }

      // Nachnamen:
      let motherNachname = '';
      let fatherNachname = nachname;

      if(status === 'verheiratet') {
        motherNachname = nachname;
      } else {
        // nur Vater Nachname, Mutter anders (hier einfach "Musterfrau")
        motherNachname = "Musterfrau";
      }

      // Alter Eltern zuf√§llig 20-40 Jahre √§lter als Kind (hier Kind Alter = 0 bei Start)
      const childAge = 0;
      const motherAge = childAge + 20 + Math.floor(Math.random()*21);
      const fatherAge = childAge + 20 + Math.floor(Math.random()*21);

      // Sexualit√§t der Eltern einzeln (80% hetero, 10% homo, 10% bi)
      function getSexuality() {
        let r = Math.random()*100;
        if(r < 80) return "hetero";
        else if(r < 90) return "homosexuell";
        else return "bisexuell";
      }

      relationships.push({
        role: 'Mutter',
        name: 'Maria',
        nachname: motherNachname,
        geschlecht: motherGender,
        alter: motherAge,
        sexualitaet: getSexuality()
      });

      relationships.push({
        role: 'Vater',
        name: 'Max',
        nachname: fatherNachname,
        geschlecht: fatherGender,
        alter: fatherAge,
        sexualitaet: getSexuality()
      });

      return relationships;
    }

    // Funktion zum Speichern im localStorage
    function savePlayerData() {
      localStorage.setItem('lebenslife_save', JSON.stringify(playerData));
    }

    // Funktion zum Laden vom localStorage
    function loadPlayerData() {
      const saved = localStorage.getItem('lebenslife_save');
      if(saved) {
        playerData = JSON.parse(saved);
        return true;
      }
      return false;
    }

    // Start des Lebens
    function startLife() {
      const vorname = document.getElementById('nameInput').value.trim();
      const nachname = document.getElementById('nachnameInput').value.trim();
      const herkunftLand = document.getElementById('herkunftLand').value;
      const ort = document.getElementById('ort').value;
      const geschlecht = document.getElementById('geschlecht').value;

      if(!vorname || !nachname || !herkunftLand || !ort || !geschlecht) {
        alert("Bitte f√ºlle alle Felder aus.");
        return;
      }

      // √úberpr√ºfe, ob die Punkteverteilung passt
      let sum = parseInt(glueckSlider.value) + parseInt(gesundheitSlider.value) + parseInt(intelligenzSlider.value) + parseInt(aussehenSlider.value);
      if(sum > totalPoints) {
        alert("Du hast mehr als 200% auf die Stats verteilt. Bitte korrigiere das.");
        return;
      }

      playerData = {
        name: vorname,
        nachname: nachname,
        herkunftLand,
        ort,
        geschlecht,
        age: 0,
        glueck: clampStat(parseInt(glueckSlider.value)),
        gesundheit: clampStat(parseInt(gesundheitSlider.value)),
        intelligenz: clampStat(parseInt(intelligenzSlider.value)),
        aussehen: clampStat(parseInt(aussehenSlider.value)),
        timeline: [],
        questQueue: [],
        questsDone: [],
        relationships: generateRelationships(vorname, nachname)
      };

      // Add first event to timeline
      playerData.timeline.push(`Du wurdest geboren in ${ort}, ${herkunftLand}.`);

      savePlayerData();
      showLifeCenter();
      renderLifeCenter();
      generateQuestsForAge(playerData.age);
      showNextQuest();
    }

    // Anzeigen des Life Centers
    function showLifeCenter() {
      document.getElementById('characterCreation').style.display = 'none';
      document.getElementById('lifeCenter').style.display = 'block';
      document.getElementById('relationshipsList').style.display = 'none';
    }

    // Lebensmittelpunkt rendern (Stats, Buttons, Timeline)
    function renderLifeCenter() {
      document.getElementById('welcome').textContent = `Willkommen, ${playerData.name} ${playerData.nachname}! Alter: ${playerData.age}`;
      document.getElementById('statsDisplay').innerHTML = `
        <strong>Stats:</strong><br>
        Gl√ºcklichkeit: ${playerData.glueck}%<br>
        Gesundheit: ${playerData.gesundheit}%<br>
        Intelligenz: ${playerData.intelligenz}%<br>
        Aussehen: ${playerData.aussehen}%
      `;

      // Buttons deaktivieren je nach Alter
      document.getElementById('arbeitBtn').disabled = playerData.age < 16;
      if(playerData.age < 3) {
        document.getElementById('ausbildungBtn').disabled = true;
        document.getElementById('ausbildungBtn').textContent = "Ausbildung (gesperrt)";
        document.getElementById('freizeitBtn').disabled = true;
        document.getElementById('freizeitBtn').textContent = "Freizeit (gesperrt)";
      } else if(playerData.age >= 3 && playerData.age < 6) {
        document.getElementById('ausbildungBtn').disabled = false;
        document.getElementById('ausbildungBtn').textContent = "Kindergarten";
        document.getElementById('freizeitBtn').disabled = false;
        document.getElementById('freizeitBtn').textContent = "Freizeit";
      } else {
        document.getElementById('ausbildungBtn').disabled = false;
        document.getElementById('ausbildungBtn').textContent = "Ausbildung";
        document.getElementById('freizeitBtn').disabled = false;
        document.getElementById('freizeitBtn').textContent = "Freizeit";
      }

      // Timeline anzeigen
      const timelineDiv = document.getElementById('timeline');
      timelineDiv.innerHTML = '';
      playerData.timeline.forEach((event, idx) => {
        timelineDiv.innerHTML += `<div>${event}</div>`;
      });
    }

    // Alters-Button Funktion (+ Alter)
    document.getElementById('ageUpBtn').addEventListener('click', () => {
      playerData.age++;
      playerData.timeline.push(`Du bist jetzt ${playerData.age} Jahre alt.`);
      generateQuestsForAge(playerData.age);
      savePlayerData();
      renderLifeCenter();
      showNextQuest();
    });

    // Beziehungen anzeigen
    document.getElementById('beziehungenBtn').addEventListener('click', () => {
      const relDiv = document.getElementById('relationshipsList');
      const ul = document.getElementById('relationshipsUl');
      ul.innerHTML = '';
      playerData.relationships.forEach(rel => {
        ul.innerHTML += `<li><strong>${rel.role}:</strong> ${rel.name} ${rel.nachname} | Geschlecht: ${rel.geschlecht} | Alter: ${rel.alter} | Sexualit√§t: ${rel.sexualitaet}</li>`;
      });
      relDiv.style.display = 'block';
    });

    function hideRelationships() {
      document.getElementById('relationshipsList').style.display = 'none';
    }

    // Questverwaltung
    function generateQuestsForAge(age) {
      // F√ºr Alter 0 bis 3: 1-3 zuf√§llige Quests
      if(age < 0) return; // kein negatives Alter
      playerData.questQueue = [];

      if(age <= 3) {
        const questCount = 1 + Math.floor(Math.random()*3);
        for(let i=0; i<questCount; i++) {
          playerData.questQueue.push({
            id: `baby_${i}`,
            text: `Babyquest ${i+1}: Lerne etwas neues.`,
            effect: () => {
              playerData.glueck = clampStat(playerData.glueck + 1);
              playerData.gesundheit = clampStat(playerData.gesundheit + 1);
            }
          });
        }
      } else if(age <= 12) {
        playerData.questQueue.push({
          id: 'schule',
          text: 'Gehe zur Schule und lerne.',
          effect: () => {
            playerData.intelligenz = clampStat(playerData.intelligenz + 5);
            playerData.glueck = clampStat(playerData.glueck + 1);
          }
        });
      } else if(age <= 16) {
        playerData.questQueue.push({
          id: 'hobby',
          text: 'Verfolge ein Hobby und habe Spa√ü.',
          effect: () => {
            playerData.glueck = clampStat(playerData.glueck + 5);
          }
        });
      } else if(age <= 20) {
        playerData.questQueue.push({
          id: 'ausbildung_start',
          text: 'Beginne deine Ausbildung oder dein Studium.',
          effect: () => {
            playerData.intelligenz = clampStat(playerData.intelligenz + 7);
          }
        });
      } else if(age > 20) {
        playerData.questQueue.push({
          id: 'arbeit_karriere',
          text: 'Arbeite an deiner Karriere.',
          effect: () => {
            playerData.glueck = clampStat(playerData.glueck + 2);
            playerData.gesundheit = clampStat(playerData.gesundheit - 1);
          }
        });
      }
    }

    // Zeigt die n√§chste Quest aus der Queue
    function showNextQuest() {
      const questDiv = document.getElementById('questContainer');
      questDiv.innerHTML = '';
      if(playerData.questQueue.length === 0) {
        questDiv.textContent = 'Keine neuen Quests.';
        return;
      }

      const nextQuest = playerData.questQueue[0];
      const p = document.createElement('p');
      p.textContent = nextQuest.text;

      const btnAccept = document.createElement('button');
      btnAccept.textContent = 'Quest annehmen';
      btnAccept.onclick = () => {
        // Quest Effekt ausf√ºhren
        nextQuest.effect();

        playerData.timeline.push(`Quest erledigt: ${nextQuest.text}`);
        playerData.questsDone.push(nextQuest.id);
        playerData.questQueue.shift();

        savePlayerData();
        renderLifeCenter();
        showNextQuest();
      };

      questDiv.appendChild(p);
      questDiv.appendChild(btnAccept);
    }

    // Buttons Aktionen (einfach Platzhalter f√ºr jetzt)
    document.getElementById('arbeitBtn').addEventListener('click', () => {
      alert('Du arbeitest heute. (Noch keine detaillierte Umsetzung)');
    });
    document.getElementById('ausbildungBtn').addEventListener('click', () => {
      alert('Du bist in Ausbildung/Schule. (Noch keine detaillierte Umsetzung)');
    });
    document.getElementById('freizeitBtn').addEventListener('click', () => {
      alert('Du hast Freizeit und entspannst dich. (Noch keine detaillierte Umsetzung)');
    });

    // Beim Laden versuchen zu laden
    window.onload = () => {
      if(loadPlayerData()) {
        showLifeCenter();
        renderLifeCenter();
        generateQuestsForAge(playerData.age);
        showNextQuest();
      }
    };
  </script>
</body>
</html>
