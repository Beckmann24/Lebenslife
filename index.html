<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Lebenslife</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin-top: 40px;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }
    input, select, button {
      padding: 10px;
      margin: 5px 0;
      font-size: 16px;
      width: 100%;
      max-width: 300px;
    }
    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
      text-align: left;
      max-width: 300px;
      margin-left: auto;
      margin-right: auto;
    }
    .slider-container {
      margin-bottom: 15px;
      text-align: left;
      max-width: 300px;
      margin-left: auto;
      margin-right: auto;
    }
    .slider-container span {
      display: inline-block;
      width: 80px;
    }
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    #statsDisplay {
      margin-top: 20px;
      text-align: left;
      max-width: 300px;
      margin-left: auto;
      margin-right: auto;
      background: #f0f0f0;
      padding: 10px;
      border-radius: 6px;
    }
    #questContainer button {
      width: 100%;
      margin: 5px 0;
      text-align: left;
    }
    #timeline {
      text-align: left;
      max-width: 400px;
      margin: 20px auto;
      background: #e8f4fa;
      padding: 10px;
      border-radius: 6px;
      height: 150px;
      overflow-y: auto;
      font-size: 14px;
      border: 1px solid #ccc;
    }
    #lifeButtons button {
      width: 100px;
      margin: 5px;
    }
    #relationshipsList {
      max-width: 400px;
      margin: 20px auto;
      text-align: left;
      background: #f9f9f9;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <h1>üß¨ Lebenslife</h1>

  <div id="characterCreation">
    <p>Verteile deine 200% auf die 4 Stats (max. 100% pro Stat):</p>
    <div class="slider-container">
      <label for="glueckSlider">Gl√ºcklichkeit: <span id="glueckValue">50%</span></label>
      <input type="range" min="0" max="100" value="50" id="glueckSlider" />
    </div>
    <div class="slider-container">
      <label for="gesundheitSlider">Gesundheit: <span id="gesundheitValue">50%</span></label>
      <input type="range" min="0" max="100" value="50" id="gesundheitSlider" />
    </div>
    <div class="slider-container">
      <label for="intelligenzSlider">Intelligenz: <span id="intelligenzValue">50%</span></label>
      <input type="range" min="0" max="100" value="50" id="intelligenzSlider" />
    </div>
    <div class="slider-container">
      <label for="aussehenSlider">Aussehen: <span id="aussehenValue">50%</span></label>
      <input type="range" min="0" max="100" value="50" id="aussehenSlider" />
    </div>
    <p id="pointsLeft" style="font-weight:bold;"></p>

    <label for="nameInput">Vorname:</label>
    <input type="text" id="nameInput" placeholder="Dein Vorname" />

    <label for="nachnameInput">Nachname:</label>
    <input type="text" id="nachnameInput" placeholder="Dein Nachname" />

    <label for="herkunftLand">Herkunftsland:</label>
    <select id="herkunftLand">
      <option value="" disabled selected>Bitte w√§hlen</option>
      <option>Deutschland</option>
      <option>√ñsterreich</option>
      <option>Schweiz</option>
      <option>Andere</option>
    </select>

    <label for="ort">Ort:</label>
    <select id="ort">
      <option value="" disabled selected>Bitte w√§hlen</option>
      <option>Berlin</option>
      <option>Hamburg</option>
      <option>M√ºnchen</option>
      <option>K√∂ln</option>
      <option>Andere</option>
    </select>

    <label for="geschlecht">Geschlecht:</label>
    <select id="geschlecht">
      <option value="" disabled selected>Bitte w√§hlen</option>
      <option>M√§nnlich</option>
      <option>Weiblich</option>
    </select>

    <button id="startLifeBtn" onclick="startLife()">Leben starten</button>
  </div>

  <div id="lifeCenter" style="display:none;">
    <h2 id="welcome"></h2>
    <div id="statsDisplay"></div>

    <div id="lifeButtons" style="margin-top:20px;">
      <button id="arbeitBtn">Arbeit</button>
      <button id="ausbildungBtn">Ausbildung</button>
      <button id="freizeitBtn">Freizeit</button>
      <button id="beziehungenBtn">Beziehungen</button>
      <button id="ageUpBtn" style="background-color:#4CAF50; color:white;">+ Alter</button>
    </div>

    <div id="questContainer" style="margin-top:20px;"></div>
    <h3>Lebensverlauf:</h3>
    <div id="timeline"></div>

    <div id="relationshipsList" style="display:none;">
      <h3>Beziehungen</h3>
      <ul id="relationshipsUl"></ul>
      <button onclick="hideRelationships()">Schlie√üen</button>
    </div>
  </div>

  <script>
    let playerData = null;
    const totalPoints = 200;

    // Slider Elemente
    const glueckSlider = document.getElementById('glueckSlider');
    const gesundheitSlider = document.getElementById('gesundheitSlider');
    const intelligenzSlider = document.getElementById('intelligenzSlider');
    const aussehenSlider = document.getElementById('aussehenSlider');

    // Anzeige der Werte
    const glueckValue = document.getElementById('glueckValue');
    const gesundheitValue = document.getElementById('gesundheitValue');
    const intelligenzValue = document.getElementById('intelligenzValue');
    const aussehenValue = document.getElementById('aussehenValue');
    const pointsLeft = document.getElementById('pointsLeft');

    // Aktualisiert die Anzeige und verhindert √úberschreitung von 200%
    function updateSliders() {
      let sum = parseInt(glueckSlider.value) + parseInt(gesundheitSlider.value) + parseInt(intelligenzSlider.value) + parseInt(aussehenSlider.value);
      let left = totalPoints - sum;
      pointsLeft.textContent = `Verbleibende Punkte: ${left}`;
      glueckValue.textContent = glueckSlider.value + '%';
      gesundheitValue.textContent = gesundheitSlider.value + '%';
      intelligenzValue.textContent = intelligenzSlider.value + '%';
      aussehenValue.textContent = aussehenSlider.value + '%';

      if(left < 0) {
        pointsLeft.style.color = 'red';
      } else {
        pointsLeft.style.color = 'black';
      }
    }

    glueckSlider.addEventListener('input', updateSliders);
    gesundheitSlider.addEventListener('input', updateSliders);
    intelligenzSlider.addEventListener('input', updateSliders);
    aussehenSlider.addEventListener('input', updateSliders);

    updateSliders();

    // Clamp Funktion f√ºr Stats auf 0-100%
    function clampStat(value) {
      if(value < 0) return 0;
      if(value > 100) return 100;
      return value;
    }

    // Beziehungen generieren
    function generateRelationships(name, nachname) {
      const relationships = [];

      let rand = Math.random()*100;
      let status = '';
      if(rand <= 70) status = 'verheiratet';
      else if(rand <= 80) status = 'zusammen';
      else if(rand <= 95) status = 'getrennt';
      else status = 'geschieden';

      let sexualParentsRand = Math.random()*100;
      let parentsSexuality = 'hetero';
      if(sexualParentsRand < 10) parentsSexuality = 'schwul';
      else if(sexualParentsRand < 20) parentsSexuality = 'lesbisch';

      let motherGender = 'weiblich';
      let fatherGender = 'm√§nnlich';
      if(parentsSexuality === 'lesbisch') {
        motherGender = 'weiblich';
        fatherGender = 'weiblich';
      } else if(parentsSexuality === 'schwul') {
        motherGender = 'm√§nnlich';
        fatherGender = 'm√§nnlich';
      }

      relationships.push({
        id: 0,
        type: 'Elternteil',
        name: 'Mutter ' + nachname,
        gender: motherGender,
        status: status,
        sexualOrientation: parentsSexuality
      });

      relationships.push({
        id: 1,
        type: 'Elternteil',
        name: 'Vater ' + nachname,
        gender: fatherGender,
        status: status,
        sexualOrientation: parentsSexuality
      });

      return relationships;
    }

    // Start des Lebens
    function startLife() {
      let sum = parseInt(glueckSlider.value) + parseInt(gesundheitSlider.value) + parseInt(intelligenzSlider.value) + parseInt(aussehenSlider.value);
      if(sum > totalPoints) {
        alert('Bitte verteile maximal 200% auf die 4 Stats!');
        return;
      }

      const name = document.getElementById('nameInput').value.trim();
      const nachname = document.getElementById('nachnameInput').value.trim();
      const herkunftLand = document.getElementById('herkunftLand').value;
      const ort = document.getElementById('ort').value;
      const geschlecht = document.getElementById('geschlecht').value;

      if(!name || !nachname || !herkunftLand || !ort || !geschlecht) {
        alert('Bitte f√ºlle alle Felder aus!');
        return;
      }

      playerData = {
        name: name,
        nachname: nachname,
        herkunftLand: herkunftLand,
        ort: ort,
        geschlecht: geschlecht,
        age: 0,
        glueck: parseInt(glueckSlider.value),
        gesundheit: parseInt(gesundheitSlider.value),
        intelligenz: parseInt(intelligenzSlider.value),
        aussehen: parseInt(aussehenSlider.value),
        relationships: generateRelationships(name, nachname),
        timeline: [],
        questQueue: [],
      };

      document.getElementById('characterCreation').style.display = 'none';
      document.getElementById('lifeCenter').style.display = 'block';
      document.getElementById('welcome').textContent = `Willkommen, ${playerData.name} ${playerData.nachname}!`;
      updateStats();
      generateQuestsForAge(playerData.age);
      updateQuestUI();

      // Button Events
      document.getElementById('ageUpBtn').onclick = () => {
        playerData.age++;
        playerData.timeline.push(`Du bist jetzt ${playerData.age} Jahre alt.`);
        updateStats();
        generateQuestsForAge(playerData.age);
        updateQuestUI();
        updateTimeline();
        checkGameOver();
      };

      document.getElementById('arbeitBtn').onclick = () => {
        addEventToTimeline('Du hast gearbeitet.');
        modifyStats(-1, -1, 0, 0);
      };

      document.getElementById('ausbildungBtn').onclick = () => {
        addEventToTimeline('Du hast an deiner Ausbildung gearbeitet.');
        modifyStats(0, 0, 3, 0);
      };

      document.getElementById('freizeitBtn').onclick = () => {
        addEventToTimeline('Du hast Freizeit genossen.');
        modifyStats(3, 2, 0, 0);
      };

      document.getElementById('beziehungenBtn').onclick = () => {
        showRelationships();
      };

      updateTimeline();
    }

    function addEventToTimeline(text) {
      playerData.timeline.push(text);
      updateTimeline();
    }

    function updateTimeline() {
      const timelineDiv = document.getElementById('timeline');
      timelineDiv.innerHTML = playerData.timeline.map((e,i) => `<div>${e}</div>`).join('');
      timelineDiv.scrollTop = timelineDiv.scrollHeight;
    }

    function modifyStats(glueckDelta, gesundheitDelta, intelligenzDelta, aussehenDelta) {
      playerData.glueck = clampStat(playerData.glueck + glueckDelta);
      playerData.gesundheit = clampStat(playerData.gesundheit + gesundheitDelta);
      playerData.intelligenz = clampStat(playerData.intelligenz + intelligenzDelta);
      playerData.aussehen = clampStat(playerData.aussehen + aussehenDelta);
      updateStats();
    }

    function updateStats() {
      const statsDiv = document.getElementById('statsDisplay');
      statsDiv.innerHTML = `
        <b>Alter:</b> ${playerData.age} Jahre<br />
        <b>Gl√ºcklichkeit:</b> ${playerData.glueck}%<br />
        <b>Gesundheit:</b> ${playerData.gesundheit}%<br />
        <b>Intelligenz:</b> ${playerData.intelligenz}%<br />
        <b>Aussehen:</b> ${playerData.aussehen}%
      `;
    }

    // Quests je nach Alter erzeugen
    function generateQuestsForAge(age) {
      playerData.questQueue = [];

      if(age <= 3) {
        let questCount = 1 + Math.floor(Math.random()*3);
        for(let i=0; i<questCount; i++) {
          playerData.questQueue.push({
            id: `baby_${i}`,
            text: `Babyquest ${i+1}: Lerne etwas neues.`,
            effect: () => {
              modifyStats(1, 1, 0, 0);
              addEventToTimeline(`Babyquest ${i+1} abgeschlossen.`);
            }
          });
        }
      } else if(age <= 12) {
        playerData.questQueue.push({
          id: 'schule',
          text: 'Gehe zur Schule und lerne.',
          effect: () => {
            modifyStats(1, 0, 5, 0);
            addEventToTimeline('Du hast in der Schule gelernt.');
          }
        });
        playerData.questQueue.push({
          id: 'spielen',
          text: 'Spiele mit Freunden drau√üen.',
          effect: () => {
            modifyStats(3, 2, 0, 0);
            addEventToTimeline('Du hast mit Freunden gespielt.');
          }
        });
      } else if(age <= 18) {
        playerData.questQueue.push({
          id: 'ausbildung',
          text: 'Beginne deine Ausbildung oder Schule.',
          effect: () => {
            modifyStats(0, 0, 5, 0);
            addEventToTimeline('Du hast an deiner Ausbildung gearbeitet.');
          }
        });
        playerData.questQueue.push({
          id: 'freizeit',
          text: 'Genie√üe deine Freizeit und Freunde.',
          effect: () => {
            modifyStats(4, 0, 0, 0);
            addEventToTimeline('Du hast deine Freizeit genossen.');
          }
        });
      } else {
        playerData.questQueue.push({
          id: 'arbeit',
          text: 'Arbeite hart, um deinen Lebensunterhalt zu verdienen.',
          effect: () => {
            modifyStats(-1, -1, 0, 0);
            addEventToTimeline('Du hast gearbeitet.');
          }
        });
        playerData.questQueue.push({
          id: 'partnersuche',
          text: 'Finde eine Beziehung.',
          effect: () => {
            modifyStats(5, 0, 0, 0);
            addEventToTimeline('Du hast eine Beziehung begonnen.');
            // Hier kann man noch Beziehung hinzuf√ºgen
          }
        });
      }
    }

    // UI f√ºr Quests
    function updateQuestUI() {
      const questContainer = document.getElementById('questContainer');
      questContainer.innerHTML = '';
      if(playerData.questQueue.length === 0) {
        questContainer.innerHTML = '<p>Keine Quests verf√ºgbar.</p>';
        return;
      }
      playerData.questQueue.forEach(q => {
        const btn = document.createElement('button');
        btn.textContent = q.text;
        btn.onclick = () => {
          q.effect();
          // Quest entfernen
          playerData.questQueue = playerData.questQueue.filter(quest => quest.id !== q.id);
          updateQuestUI();
          updateStats();
          updateTimeline();
          checkGameOver();
        };
        questContainer.appendChild(btn);
      });
    }

    // Beziehungen anzeigen
    function showRelationships() {
      const listDiv = document.getElementById('relationshipsList');
      const ul = document.getElementById('relationshipsUl');
      ul.innerHTML = '';
      playerData.relationships.forEach(rel => {
        let li = document.createElement('li');
        li.textContent = `${rel.type}: ${rel.name} (${rel.gender}), Status: ${rel.status}, Sexualit√§t: ${rel.sexualOrientation}`;
        ul.appendChild(li);
      });
      listDiv.style.display = 'block';
    }

    function hideRelationships() {
      document.getElementById('relationshipsList').style.display = 'none';
    }

    // Spielende bei Tod simulieren
    function checkGameOver() {
      if(playerData.gesundheit <= 0) {
        alert('Dein Charakter ist leider gestorben. Spiel vorbei.');
        location.reload();
      }
    }
  </script>
</body>
</html>
